clc
clear

n=344;
a=zeros(n);
A=xlsread('C:\Users\hp\Desktop\Volume20200106.xlsx','20.30-21.00');

for m = 1 :115684;
    a(A(m,1),A(m,2))=A(m,3);
end

% a;%客流矩阵
b=zeros(n);
B=xlsread('C:\Users\hp\Desktop\Beijinghalf.xlsx','2019');

for p = 1 :388;
    b(B(p,1),B(p,2))=1;
end

b=b+b';
b(b==0)=inf;

for f=1:n;
    c=a;
    c(f,:)=0;
    c(:,f)=0;
    
    d=b;
    d(f,:)=inf;
    d(:,f)=inf; 
    
    d([1:n+1:n^2])=0;
    
    for k=1:n;
    for i = 1:n;
        for j=1:n;
            if d(i,j)>d(i,k)+d(k,j);
                d(i,j)=d(i,k)+d(k,j);
            end
        end
    end
end
    
    D=1./d;
D(D==inf)=0;
D;%最短路倒数矩阵

e=c.*D;
E=(sum(e(:)))/(343*342*121477);
disp(E)

  end









