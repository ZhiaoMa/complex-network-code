

n=344;

a=zeros(n);
A=xlsread('C:\Users\hp\Desktop\Beijinghalf.xlsx','2019');

for m = 1 :388;
    a(A(m,1),A(m,2))=1;
end

a=a+a';
a(a==0)=inf;
a([1:n+1:n^2])=0;

% b=304;G=296;

% a(184,183)=inf;a(183,184)=inf;a(184,185)=inf;a(185,184)=inf;
% a(84,83)=inf;a(83,84)=inf;a(84,85)=inf;a(85,84)=inf;a(84,121)=inf;a(121,84)=inf;a(84,49)=inf;a(49,84)=inf;
% a(58,57)=inf;a(57,58)=inf;a(58,59)=inf;a(59,58)=inf;
% a(283,110)=inf;a(110,283)=inf;a(283,26)=inf;a(26,283)=inf;
% a(344,343)=inf;a(343,344)=inf;a(344,305)=inf;a(305,344)=inf;
% 
% a(244,243)=inf;a(243,244)=inf;a(244,245)=inf;a(245,244)=inf;
% a(321,63)=inf;a(63,321)=inf;a(321,287)=inf;a(287,321)=inf;
% a(11,10)=inf;a(10,11)=inf;a(11,12)=inf;a(12,11)=inf;
% a(4,3)=inf;a(3,4)=inf;a(4,5)=inf;a(5,4)=inf;
% a(272,273)=inf;a(273,272)=inf;
% 
% a(172,164)=inf;a(164,172)=inf;a(172,303)=inf;a(303,172)=inf;a(172,309)=inf;a(309,172)=inf;a(172,310)=inf;a(310,172)=inf;
% a(338,337)=inf;a(337,338)=inf;a(338,339)=inf;a(339,338)=inf;
% a(70,28)=inf;a(28,70)=inf;a(70,71)=inf;a(71,70)=inf;
% a(85,84)=inf;a(84,85)=inf;a(85,39)=inf;a(39,85)=inf;
% a(108,107)=inf;a(107,108)=inf;a(108,109)=inf;a(109,108)=inf;
% 
% a(56,55)=inf;a(55,56)=inf;a(56,57)=inf;a(57,56)=inf;
% a(17,16)=inf;a(16,17)=inf;a(17,18)=inf;a(18,17)=inf;a(17,33)=inf;a(33,17)=inf;a(17,66)=inf;a(66,17)=inf;
% a(35,34)=inf;a(34,35)=inf;a(35,36)=inf;a(36,35)=inf;
% a(177,176)=inf;a(176,177)=inf;a(177,178)=inf;a(178,177)=inf;
% a(311,310)=inf;a(310,311)=inf;a(311,312)=inf;a(312,311)=inf;
% 
% a(96,95)=inf;a(95,96)=inf;a(96,264)=inf;a(264,96)=inf;
% a(68,67)=inf;a(67,68)=inf;a(68,69)=inf;a(69,68)=inf;
% a(295,294)=inf;a(294,295)=inf;a(295,296)=inf;a(296,295)=inf;
% a(54,53)=inf;a(53,54)=inf;a(54,13)=inf;a(13,54)=inf;
% a(109,108)=inf;a(108,109)=inf;a(109,110)=inf;a(110,109)=inf;a(109,128)=inf;a(128,109)=inf;a(109,129)=inf;a(129,109)=inf;
% 
% a(217,216)=inf;a(216,217)=inf;a(217,218)=inf;a(218,217)=inf;
% a(206,205)=inf;a(205,206)=inf;a(206,207)=inf;a(207,206)=inf;
% a(75,74)=inf;a(74,75)=inf;a(75,76)=inf;a(76,75)=inf;
% a(128,127)=inf;a(127,128)=inf;a(128,109)=inf;a(109,128)=inf;
% a(136,89)=inf;a(89,136)=inf;a(136,20)=inf;a(20,136)=inf;
% 
% a(335,334)=inf;a(334,335)=inf;a(335,336)=inf;a(336,335)=inf;
% a(110,109)=inf;a(109,110)=inf;a(110,283)=inf;a(283,110)=inf;
% a(74,73)=inf;a(73,74)=inf;a(74,75)=inf;a(75,74)=inf;a(74,301)=inf;a(301,74)=inf;a(74,302)=inf;a(302,74)=inf;
% a(150,149)=inf;a(149,150)=inf;a(150,151)=inf;a(151,150)=inf;
% a(183,23)=inf;a(23,183)=inf;a(183,184)=inf;a(184,183)=inf;
% 
% a(61,62)=inf;a(62,61)=inf;a(61,142)=inf;a(142,61)=inf;a(61,143)=inf;a(143,61)=inf;a(61,199)=inf;a(199,61)=inf;
% a(260,259)=inf;a(259,260)=inf;a(260,261)=inf;a(261,260)=inf;
% a(193,192)=inf;a(192,193)=inf;a(193,305)=inf;a(305,193)=inf;
% a(32,18)=inf;a(18,32)=inf;a(32,33)=inf;a(33,32)=inf;
% a(146,59)=inf;a(59,146)=inf;a(146,147)=inf;a(147,146)=inf;a(146,281)=inf;a(281,146)=inf;




% a(24,25)=inf;a(25,24)=inf;a(24,39)=inf;a(39,24)=inf;a(24,50)=inf;a(50,24)=inf;a(24,51)=inf;a(51,24)=inf;a(24,157)=inf;a(157,24)=inf;
% a(132,131)=inf;a(131,132)=inf;a(132,133)=inf;a(133,132)=inf;a(132,29)=inf;a(29,132)=inf;a(132,221)=inf;a(221,132)=inf;a(132,222)=inf;a(222,132)=inf;
% a(8,7)=inf;a(7,8)=inf;a(8,9)=inf;a(9,8)=inf;a(8,152)=inf;a(152,8)=inf;a(8,153)=inf;a(153,8)=inf;
% a(9,8)=inf;a(8,9)=inf;a(9,10)=inf;a(10,9)=inf;a(9,120)=inf;a(120,9)=inf;a(9,121)=inf;a(121,9)=inf;
% a(12,11)=inf;a(11,12)=inf;a(12,13)=inf;a(13,12)=inf;a(12,37)=inf;a(37,12)=inf;a(12,38)=inf;a(38,12)=inf;
% 
% a(13,12)=inf;a(12,13)=inf;a(13,14)=inf;a(14,13)=inf;a(13,54)=inf;a(54,13)=inf;a(13,36)=inf;a(36,13)=inf;
% a(17,16)=inf;a(16,17)=inf;a(17,18)=inf;a(18,17)=inf;a(17,33)=inf;a(33,17)=inf;a(17,66)=inf;a(66,17)=inf;
% a(18,17)=inf;a(17,18)=inf;a(18,19)=inf;a(19,18)=inf;a(18,31)=inf;a(31,18)=inf;a(18,32)=inf;a(32,18)=inf;
% a(20,19)=inf;a(19,20)=inf;a(20,21)=inf;a(21,20)=inf;a(20,136)=inf;a(136,20)=inf;a(20,137)=inf;a(137,20)=inf;
% a(21,20)=inf;a(20,21)=inf;a(21,22)=inf;a(22,21)=inf;a(21,90)=inf;a(90,21)=inf;a(21,317)=inf;a(317,21)=inf;
% 
% a(26,25)=inf;a(25,26)=inf;a(26,27)=inf;a(27,26)=inf;a(26,111)=inf;a(111,26)=inf;a(26,283)=inf;a(283,26)=inf;
% a(28,29)=inf;a(29,28)=inf;a(28,27)=inf;a(27,28)=inf;a(28,69)=inf;a(69,28)=inf;a(28,70)=inf;a(70,28)=inf;
% a(29,28)=inf;a(28,29)=inf;a(29,30)=inf;a(30,29)=inf;a(29,166)=inf;a(166,29)=inf;a(29,132)=inf;a(132,29)=inf;
% a(31,30)=inf;a(30,31)=inf;a(31,18)=inf;a(18,31)=inf;a(31,67)=inf;a(67,31)=inf;a(31,88)=inf;a(88,31)=inf;
% a(33,32)=inf;a(32,33)=inf;a(33,34)=inf;a(34,33)=inf;a(33,65)=inf;a(65,33)=inf;a(33,17)=inf;a(17,33)=inf;
% 
% a(36,35)=inf;a(35,36)=inf;a(36,37)=inf;a(37,36)=inf;a(36,13)=inf;a(13,36)=inf;a(36,55)=inf;a(55,36)=inf;
% a(39,38)=inf;a(38,39)=inf;a(39,24)=inf;a(24,39)=inf;a(39,85)=inf;a(85,39)=inf;a(39,52)=inf;a(52,39)=inf;
% a(46,45)=inf;a(45,46)=inf;a(46,47)=inf;a(47,46)=inf;a(46,123)=inf;a(123,46)=inf;a(46,124)=inf;a(124,46)=inf;
% a(52,51)=inf;a(51,52)=inf;a(52,53)=inf;a(53,52)=inf;a(52,39)=inf;a(39,52)=inf;a(52,86)=inf;a(86,52)=inf;
% a(55,36)=inf;a(36,55)=inf;a(55,56)=inf;a(56,55)=inf;a(55,325)=inf;a(325,55)=inf;a(55,326)=inf;a(326,55)=inf;
% 
% b=304;G=226;
% 
% a(59,58)=inf;a(58,59)=inf;a(59,60)=inf;a(60,59)=inf;a(59,145)=inf;a(145,59)=inf;a(59,146)=inf;a(146,59)=inf;
% a(61,62)=inf;a(62,61)=inf;a(61,142)=inf;a(142,61)=inf;a(61,143)=inf;a(143,61)=inf;a(61,199)=inf;a(199,61)=inf;
% a(63,62)=inf;a(62,63)=inf;a(63,64)=inf;a(64,63)=inf;a(63,320)=inf;a(320,63)=inf;a(63,321)=inf;a(321,63)=inf;
% a(65,64)=inf;a(64,65)=inf;a(65,33)=inf;a(33,65)=inf;a(65,327)=inf;a(327,65)=inf;a(65,328)=inf;a(328,65)=inf;
% a(67,66)=inf;a(66,67)=inf;a(67,68)=inf;a(68,67)=inf;a(67,87)=inf;a(87,67)=inf;a(67,31)=inf;a(31,67)=inf;
% 
% a(72,71)=inf;a(71,72)=inf;a(72,73)=inf;a(73,72)=inf;a(72,129)=inf;a(129,72)=inf;a(72,130)=inf;a(130,72)=inf;
% a(74,73)=inf;a(73,74)=inf;a(74,75)=inf;a(75,74)=inf;a(74,301)=inf;a(301,74)=inf;a(74,302)=inf;a(302,74)=inf;
% a(77,76)=inf;a(76,77)=inf;a(77,78)=inf;a(78,77)=inf;a(77,101)=inf;a(101,77)=inf;a(77,163)=inf;a(163,77)=inf;
% a(82,81)=inf;a(81,82)=inf;a(82,83)=inf;a(83,82)=inf;a(82,153)=inf;a(153,82)=inf;a(82,154)=inf;a(154,82)=inf;
% a(84,83)=inf;a(83,84)=inf;a(84,85)=inf;a(85,84)=inf;a(84,121)=inf;a(121,84)=inf;a(84,49)=inf;a(49,84)=inf;
% 
% a(87,86)=inf;a(86,87)=inf;a(87,67)=inf;a(67,87)=inf;a(87,111)=inf;a(111,87)=inf;a(87,284)=inf;a(284,87)=inf;
% a(89,88)=inf;a(88,89)=inf;a(89,90)=inf;a(90,89)=inf;a(89,135)=inf;a(135,89)=inf;a(89,136)=inf;a(136,89)=inf;
% a(90,89)=inf;a(89,90)=inf;a(90,91)=inf;a(91,90)=inf;a(90,316)=inf;a(316,90)=inf;a(90,21)=inf;a(21,90)=inf;
% a(101,100)=inf;a(100,101)=inf;a(101,102)=inf;a(102,101)=inf;a(101,162)=inf;a(162,101)=inf;a(101,77)=inf;a(77,101)=inf;
% a(107,106)=inf;a(106,107)=inf;a(107,108)=inf;a(108,107)=inf;a(107,300)=inf;a(300,107)=inf;a(107,301)=inf;a(301,107)=inf;
% 
% a(109,108)=inf;a(108,109)=inf;a(109,110)=inf;a(110,109)=inf;a(109,128)=inf;a(128,109)=inf;a(109,129)=inf;a(129,109)=inf;
% a(117,116)=inf;a(116,117)=inf;a(117,118)=inf;a(118,117)=inf;a(117,171)=inf;a(171,117)=inf;a(117,151)=inf;a(151,117)=inf;
% a(118,117)=inf;a(117,118)=inf;a(118,119)=inf;a(119,118)=inf;a(118,151)=inf;a(151,118)=inf;a(118,152)=inf;a(152,118)=inf;
% a(125,124)=inf;a(124,125)=inf;a(125,126)=inf;a(126,125)=inf;a(125,157)=inf;a(157,125)=inf;a(125,158)=inf;a(158,125)=inf;
% a(130,72)=inf;a(72,130)=inf;a(130,131)=inf;a(131,130)=inf;a(130,164)=inf;a(164,130)=inf;a(130,165)=inf;a(165,130)=inf;



for k=1:n;
    for i = 1:n;
        for j=1:n;
            if a(i,j)>a(i,k)+a(k,j);
                a(i,j)=a(i,k)+a(k,j);
            end
        end
    end
end



uT=(G-b+1)/b

r=G/(3*b-6)

D=1./a;
D(D==inf)=0;
E=(sum(D(:)))/(b*(b-1))

% 圈数率ut
% 
% x=[0 1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31	32	33	34	35	36	37	38	39	40];  %Planing density
% 
% y1=[0.13 0.1283	0.1199	0.1173	0.1147	0.1121	0.1095	0.1068	0.1042	0.1015	0.1018	0.0931	0.0904	0.0876	0.0848	0.0821	0.0793	0.0703	0.0675	0.0646	0.0617	0.0588	0.0559	0.053	0.05	0.0408	0.0377	0.0347	0.0316	0.0286	0.0255	0.0224	0.0192	0.0096	0.0065	0.0032	0	0	0	0	0
% ]; 
% 
% 
% y2=[0.13 0.1195	0.1082	0.0997	0.0912	0.0826	0.074	0.0653	0.0565	0.0478	0.0389	0.03	0.0211	0.0121	0.003	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
% ]; 
% 
% 
% axis([0 40  0 0.15])
% 
% plot(x,y1,'*-',x,y2,'s-')
% 
% legend('随机攻击','蓄意攻击');


% 连通度r

% x=[0 1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31	32	33	34	35	36	37	38	39	40];  
% 
% y1=[0.378 0.3773	0.3745	0.3736	0.3728	0.3719	0.371	0.3701	0.3693	0.3684	0.3685	0.3656	0.3646	0.3637	0.3628	0.3619	0.3609	0.3579	0.357	0.356	0.3551	0.3541	0.3531	0.3521	0.3512	0.3481	0.347	0.346	0.345	0.344	0.3429	0.3419	0.3409	0.3376	0.3366	0.3355	0.3322	0.3311	0.33	0.3289	0.3267
% ]; 
% 
% y2=[0.378 0.3744	0.3706	0.3677	0.3649	0.362	0.3591	0.3562	0.3533	0.3504	0.3474	0.3444	0.3414	0.3384	0.3354	0.3323	0.3292	0.3262	0.323	0.3199	0.3168	0.3136	0.3104	0.3072	0.304	0.3007	0.2975	0.2942	0.2909	0.2875	0.2842	0.2808	0.2774	0.274	0.2706	0.2671	0.2636	0.2601	0.2566	0.253	0.2494
% ];  
% 
% 
% axis([0 40 0 0.4])
% 
% plot(x,y1,'s-',x,y2,'p-')
% 
% legend('随机攻击','蓄意攻击');


% 全局效率

% x=[0 1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31	32	33	34	35	36	37	38	39	40];  
% 
% y1=[0.0884 0.0873	0.086	0.0852	0.0848	0.0828	0.0816	0.0812	0.0801	0.0792	0.0795	0.074	0.0729	0.0726	0.0725	0.0721	0.0718	0.0711	0.0706	0.0708	0.0705	0.0685	0.0683	0.0681	0.0678	0.0669	0.065	0.0639	0.0637	0.0637	0.0634	0.0628	0.0633	0.0627	0.0616	0.0616	0.054	0.0524	0.0526	0.0518	0.0516
% ]; 
% 
% y2=[0.0884 0.0865	0.0848	0.0814	0.0799	0.0784	0.0772	0.0749	0.0721	0.0711	0.0498	0.049	0.0484	0.0476	0.0462	0.0458	0.045	0.0425	0.0361	0.0361	0.0355	0.03	0.0282	0.0277	0.0265	0.0265	0.0255	0.0245	0.0202	0.0193	0.0192	0.0192	0.0186	0.018	0.0176	0.0168	0.0164	0.0151	0.0149	0.0145	0.0141
% ];  
% 
% 
% axis([0 40 0 0.9])
% 
% plot(x,y1,'s-',x,y2,'p-')
% 
% legend('随机攻击','蓄意攻击');







